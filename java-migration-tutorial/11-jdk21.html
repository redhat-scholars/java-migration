<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java 21 :: Java Migration Tutorial</title>
    <link rel="canonical" href="https://github.com/redhat-scholars/java-migration/java-migration-tutorial/11-jdk21.html">
    <link rel="prev" href="09-jdk19.html">
    <link rel="next" href="98-preview.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://github.com/redhat-scholars/java-migration">Java Migration Tutorial</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="java-migration-tutorial" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#prerequisite">Prerequisites</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-jdk12.html">2. Java 12</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-jdk12.html#strings">Strings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-jdk12.html#path">Path</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-jdk12.html#number">Number Format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-jdk12.html#streams">Streams</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-jdk13.html">3. Java 13</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-jdk13.html#path">Path</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-jdk14.html">4. Java 14</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-jdk14.html#datetime">Date Time Formatter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-jdk14.html#switch">Switch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-jdk15.html">5. Java 15</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:05-jdk15.adoc#textblocks</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-jdk15.html#null">Null Pointer Information</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-jdk16.html">6. Java 16</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:06-jdk16.adoc#streams</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-jdk16.html#records">Records</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="07-jdk17.html">7. Java 17</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:07-jdk17.adoc#sealed</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="07-jdk17.html#instantsource">Instant Source</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="07-jdk17.html#random">Random class</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="08-jdk18.html">8. Java 18</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:08-jdk18.adoc#divideexact</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-jdk18.html#defaultcharset">Default Charset</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-jdk18.html#javadoc">Javadoc Snippet</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="09-jdk19.html">9. Java 19</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:09-jdk19.adoc#locale</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-jdk19.html#parallelm">Parallel Multiply</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="11-jdk21.html">10. Java 21</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:11-jdk21.adoc#repeat</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#patternmatching">Pattern Matching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#switch">Switch Expression</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#virtualthreads">Virtual Threads</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#kem">Key Encapsulation Mechanism</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="98-preview.html">11. Java Preview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">xref:98-preview.adoc#stringtemplate</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="98-preview.html#unnamedvars">Unamed Variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="98-preview.html#structuredconcurrency">Structured Concurrency API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="98-preview.html#scoped">Scoped Values</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Java Migration Tutorial</a></li>
    <li><a href="11-jdk21.html">10. Java 21</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/java-migration/edit/master/documentation/modules/ROOT/pages/11-jdk21.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Java 21</h1>
<div class="sect1">
<h2 id="repeat"><a class="anchor" href="#repeat"></a>Repeat</h2>
<div class="sectionbody">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">StringBuilder sb = new StringBuilder();
sb.append("Hello").repeat(" world", 5);
System.out.println(sb.toString());</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Hello world world world world world</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="math"><a class="anchor" href="#math"></a>Math Clamp</h2>
<div class="sectionbody">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">System.out.println(Math.clamp(23, 25, 30));</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">25</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="patternmatching"><a class="anchor" href="#patternmatching"></a>Pattern Matching for Instaceof</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the new <code>instanceof</code> operation, you can validate type and cast to type with just one line:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Object numberObject = Integer.parseInt("1");

if (numberObject instanceof Integer i) {
    System.out.println(i.intValue());
}</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also it is supported by records:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">var developer = new Developer("Alexandra", 8);
if (developer instanceof Developer(String name, int age)) {
    System.out.println(name + " " + age);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="switch"><a class="anchor" href="#switch"></a>Switch Expression</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_pattern_matching_with_switch"><a class="anchor" href="#_pattern_matching_with_switch"></a>Pattern Matching with Switch</h3>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">switch (dev) {
    case Developer d -&gt; System.out.println("I am a developer");
    default -&gt; System.out.println("I don't know");
}</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">I m a developer</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_type_and_guarded_patterns"><a class="anchor" href="#_type_and_guarded_patterns"></a>Type and Guarded Patterns</h3>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Object price = 1000;

String description = switch (price) {
    case Integer i when i &gt; 900 -&gt; "This is a big number " + i.toString();
    case Integer i -&gt; "This is a normal number " + i.toString();
    case Long l -&gt; "A long number " + l.toString();
    default -&gt; price.toString();
};

System.out.println(description);</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">This is a big number 1000</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="virtualthreads"><a class="anchor" href="#virtualthreads"></a>Virtual Threads</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From Java documentation:</p>
</div>
<div class="paragraph">
<p><em>A virtual thread still runs code on an OS thread. However, when code running in a virtual thread calls a blocking I/O operation, the Java runtime suspends the virtual thread until it can be resumed. The OS thread associated with the suspended virtual thread is now free to perform operations for other virtual threads.</em></p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try (var executor = Executors.newVirtualThreadPerTaskExecutor()) {
    IntStream.range(0, 10).forEach(i -&gt; {
    executor.submit(() -&gt; {
        System.out.println(STR."{i}");
        });
    });
}</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">3
4
1
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kem"><a class="anchor" href="#kem"></a>Key Encapsulation Mechanism [JDK 21]</h2>
<div class="sectionbody">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">var kpg = KeyPairGenerator.getInstance("X25519");
var kp = kpg.generateKeyPair();

      // Sender
var kem1 = KEM.getInstance("DHKEM");
var sender = kem1.newEncapsulator(kp.getPublic());
var encapsulated = sender.encapsulate();
var k1 = encapsulated.key();

      // Receiver
var kem2 = KEM.getInstance("DHKEM");
var receiver = kem2.newDecapsulator(kp.getPrivate());
var k2 = receiver.decapsulate(encapsulated.encapsulation());

System.out.println(k2.equals(k1));</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">true</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="09-jdk19.html">9. Java 19</a></span>
  <span class="next"><a href="98-preview.html">11. Java Preview</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
